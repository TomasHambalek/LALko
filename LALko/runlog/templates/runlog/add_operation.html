{% extends "runlog/base.html" %}

{% block content %}
<div class="container mt-4">
    <h2 class="mb-4">Add new operation</h2>
    <form method="post" class="needs-validation" novalidate>
        {% csrf_token %}

        <div class="row">
            <div class="col-md-6">
                <div class="mb-3">
                    <label for="{{ form.project_number.id_for_label }}" class="form-label">Project Number</label>
                    {{ form.project_number }}
                </div>
                <div class="mb-3">
                    <label for="{{ form.aac_mold_number.id_for_label }}" class="form-label">AAC Mold Number</label>
                    {{ form.aac_mold_number }}
                </div>
                <div class="mb-3">
                    <label for="{{ form.mold_number.id_for_label }}" class="form-label">Mold Number</label>
                    {{ form.mold_number }}
                </div>
                <div class="mb-3">
                    <label for="{{ form.surface.id_for_label }}" class="form-label">Surface</label>
                    {{ form.surface }}
                </div>
                <div class="mb-3">
                    <label for="{{ form.moldset_preform.id_for_label }}" class="form-label">Moldset Preform</label>
                    {{ form.moldset_preform }}
                </div>
                <div class="mb-3">
                    <label for="{{ form.parent_layout.id_for_label }}" class="form-label">Parent Layout</label>
                    {{ form.parent_layout }}
                </div>
                <div class="mb-3">
                    <label for="{{ form.machine.id_for_label }}" class="form-label">Machine</label>
                    {{ form.machine }}
                </div>
                <div class="mb-3">
                    <label for="{{ form.machining_type.id_for_label }}" class="form-label">Machining Type</label>
                    {{ form.machining_type }}
                </div>
                <div class="mb-3">
                    <label for="{{ form.operators.id_for_label }}" class="form-label">Operators</label>
                    {{ form.operators }}
                    <div class="form-text text-muted">{{ form.operators.help_text }}</div>
                </div>
                <div class="mb-3">
                    <label for="{{ form.status.id_for_label }}" class="form-label">Status</label>
                    {{ form.status }}
                </div>
                <div class="mb-3">
                    <label for="{{ form.task.id_for_label }}" class="form-label">Task</label>
                    {{ form.task }}
                </div>
                <div class="mb-3">
                    <label for="{{ form.description.id_for_label }}" class="form-label">Description</label>
                    {{ form.description }}
                </div>
                <div class="mb-3">
                    <label for="{{ form.x_levelling.id_for_label }}" class="form-label">X Levelling</label>
                    {{ form.x_levelling }}
                </div>
                <div class="mb-3">
                    <label for="{{ form.y_levelling.id_for_label }}" class="form-label">Y Levelling</label>
                    {{ form.y_levelling }}
                </div>
                <div class="mb-3">
                    <label for="{{ form.start_time.id_for_label }}" class="form-label">Start Time</label>
                    {{ form.start_time }}
                    <button type="button" class="btn btn-secondary btn-sm mt-1" onclick="setNow('id_start_time')">Set to Now</button>
                </div>
                <div class="mb-3">
                    <label for="{{ form.end_time.id_for_label }}" class="form-label">End Time</label>
                    {{ form.end_time }}
                    <button type="button" class="btn btn-secondary btn-sm mt-1" onclick="setNow('id_end_time')">Set to Now</button>
                </div>
                <div class="mb-3">
                    <label for="{{ form.note.id_for_label }}" class="form-label">Note</label>
                    {{ form.note }}
                </div>
                <div class="mb-3">
                    <label for="{{ form.note2.id_for_label }}" class="form-label">Note 2</label>
                    {{ form.note2 }}
                </div>
            </div>
        </div>

        <script>
        function setNow(fieldId) {
            const now = new Date();
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const formattedTime = `${year}-${month}-${day}T${hours}:${minutes}`;
            document.getElementById(fieldId).value = formattedTime;
        }
        </script>
        
        <button type="submit" class="btn btn-primary mt-3">Save Operation</button>
    </form>
</div>
{% endblock %}